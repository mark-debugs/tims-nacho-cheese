---
phase: 02-product-showcase
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - tailwind.config.js
  - src/lib/utils/scroll-animations.ts
  - src/lib/actions/inview.ts
  - src/lib/actions/cheese-stretch.ts
  - src/routes/+layout.svelte
  - src/lib/data/flavors.ts
autonomous: true

must_haves:
  truths:
    - "Page transitions animate smoothly when navigating between routes"
    - "Scroll-triggered animation utilities exist and are importable"
    - "Cheese-stretch hover action creates elastic scale effect on elements"
    - "Per-flavor animation configs map each flavor ID to a unique entrance style"
    - "Flavor data is centralized in a typed data module with all 5 flavors"
  artifacts:
    - path: "src/lib/utils/scroll-animations.ts"
      provides: "Per-flavor animation configs and getFlavorAnimation helper"
      exports: ["flavorAnimations", "getFlavorAnimation"]
    - path: "src/lib/actions/inview.ts"
      provides: "Svelte action for scroll-triggered viewport detection"
      exports: ["inview"]
    - path: "src/lib/actions/cheese-stretch.ts"
      provides: "Elastic hover stretch action for cards and buttons"
      exports: ["cheeseStretch"]
    - path: "src/lib/data/flavors.ts"
      provides: "Typed flavor data array with all 5 products"
      exports: ["flavors", "Flavor"]
    - path: "tailwind.config.js"
      provides: "Custom keyframes and new flavor colors (mozz, white-cheese)"
      contains: "flameFlicker"
  key_links:
    - from: "src/lib/utils/scroll-animations.ts"
      to: "svelte/transition"
      via: "imports fly, scale"
      pattern: "import.*from.*svelte/transition"
    - from: "src/lib/actions/cheese-stretch.ts"
      to: "svelte/motion"
      via: "imports spring"
      pattern: "import.*spring.*from.*svelte/motion"
    - from: "src/routes/+layout.svelte"
      to: "View Transitions API"
      via: "onNavigate with startViewTransition"
      pattern: "startViewTransition"
---

<objective>
Set up the animation infrastructure, flavor data model, and page transitions needed for the product showcase.

Purpose: All the utilities, actions, data, and Tailwind config extensions must exist before building the product showcase UI. This plan creates the foundation that Plan 02 consumes.

Output: Installable dependencies, importable animation utilities, reusable Svelte actions, centralized flavor data, page transitions, and Tailwind keyframes for MEGA SPICE effects.
</objective>

<execution_context>
@C:\Users\Mark\.claude/get-shit-done/workflows/execute-plan.md
@C:\Users\Mark\.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-product-showcase/02-RESEARCH.md
@.planning/phases/02-product-showcase/02-CONTEXT.md
@.planning/phases/01-foundation-infrastructure/01-01-SUMMARY.md
@.planning/phases/01-foundation-infrastructure/01-02-SUMMARY.md

Key existing files to reference:
@src/lib/utils/animations.ts
@tailwind.config.js
@src/routes/+layout.svelte
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install dependencies and extend Tailwind config with flavor colors and keyframes</name>
  <files>package.json, tailwind.config.js</files>
  <action>
1. Install svelte-inview using Bun. Check if the main `svelte-inview` package works with Svelte 5 first (test import). If it fails, try the Svelte 5 fork `svelte-5-inview` from npm. Do NOT install `sveltekit-view-transition` â€” we will use SvelteKit's built-in `onNavigate` with the View Transitions API directly (fewer deps, more control, research shows the manual pattern is simple).

2. Extend `tailwind.config.js` with:
   - New color palettes:
     - `mozz` (mozzarella blue): 50: '#EFF6FF', 100: '#DBEAFE', 200: '#BFDBFE', 300: '#93C5FD', 400: '#60A5FA', 500: '#3B82F6', 600: '#2563EB', 700: '#1D4ED8', 800: '#1E40AF'
     - `white-cheese` (clean neutral gray): 50: '#FAFAFA', 100: '#F5F5F5', 200: '#E5E5E5', 300: '#D4D4D4', 400: '#A3A3A3', 500: '#737373', 600: '#525252', 700: '#404040', 800: '#262626'
   - Custom keyframes:
     - `flameFlicker`: scale(1)/translateY(0)/opacity(1) at 0%/100%, scale(1.1)/translateY(-5px)/opacity(0.85) at 50%
     - `heatShimmer`: translateX(0)/skewX(0deg) at 0%/100%, translateX(2px)/skewX(1deg) at 25%, translateX(-2px)/skewX(-1deg) at 75%
     - `cheeseDrip`: scaleY(0) at 0% (origin top), scaleY(1) at 100%
     - `wobbleIn`: rotate(-3deg) at 0%, rotate(3deg) at 50%, rotate(0deg) at 100%
   - Custom animations:
     - `flame-flicker`: 'flameFlicker 0.3s ease-in-out infinite'
     - `heat-shimmer`: 'heatShimmer 0.2s ease-in-out infinite'
     - `cheese-drip`: 'cheeseDrip 0.8s ease-out forwards'
     - `wobble-in`: 'wobbleIn 0.5s ease-out'

  </action>
  <verify>Run `bun run check` to confirm no TypeScript errors. Verify tailwind.config.js is valid by checking `bun run build` succeeds.</verify>
  <done>package.json has svelte-inview dependency. tailwind.config.js has mozz and white-cheese color palettes plus 4 custom keyframes and 4 custom animations.</done>
</task>

<task type="auto">
  <name>Task 2: Create animation utilities, Svelte actions, flavor data, and page transitions</name>
  <files>src/lib/utils/scroll-animations.ts, src/lib/actions/inview.ts, src/lib/actions/cheese-stretch.ts, src/lib/data/flavors.ts, src/routes/+layout.svelte</files>
  <action>
1. Create `src/lib/utils/scroll-animations.ts`:
   - Import `fly`, `scale` from `svelte/transition`
   - Import `quintOut`, `elasticOut`, `backOut` from `svelte/easing`
   - Export `flavorAnimations` object mapping flavor IDs to transition configs:
     - `white-cheese`: fly, y: 30, duration: 400, easing: quintOut (gentle fade-slide, clean and mild)
     - `orange-spice`: scale, start: 0.8, duration: 400, easing: elasticOut (classic bounce)
     - `mozz-pure`: fly, y: -50, duration: 500, easing: backOut (stretch from top, silky)
     - `cheddar-beddar`: scale, start: 0.7, duration: 300, easing: backOut (bold pop-in)
     - `mega-spice`: scale, start: 1.3, duration: 600, easing: elasticOut, opacity: 0 (explosive burst)
   - Export `getFlavorAnimation(flavorId: string)` helper that returns the config (defaults to white-cheese)

2. Create `src/lib/actions/inview.ts`:
   - Create a Svelte 5 compatible action using Intersection Observer API directly (don't rely on svelte-inview if it has Svelte 5 issues â€” the manual implementation is 20 lines and bulletproof)
   - The action should:
     - Accept options: `{ rootMargin?: string, threshold?: number, once?: boolean }`
     - Default: rootMargin '50px', threshold 0.1, once true
     - Dispatch `inview_enter` and `inview_exit` CustomEvents on the node
     - If `once` is true, disconnect observer after first enter
     - Return `{ destroy() }` that disconnects the observer
   - Export the action as `inview`

3. Create `src/lib/actions/cheese-stretch.ts`:
   - Import `spring` from `svelte/motion`
   - Import `prefersReducedMotion` from `$lib/utils/animations`
   - Create action `cheeseStretch(node: HTMLElement)`:
     - Create a spring store with value 1, stiffness 0.1, damping 0.25
     - Subscribe to spring, apply `transform: scale(${value})` to node
     - On mouseenter: set spring to 1.05
     - On mouseleave: set spring to 1
     - If prefersReducedMotion() is true, skip (return empty destroy)
     - Return `{ destroy() }` that unsubscribes and removes listeners
   - Export the action

4. Create `src/lib/data/flavors.ts`:
   - Define and export `Flavor` type:
     ```typescript
     export type Flavor = {
       id: string;
       name: string;
       tagline: string;
       description: string;
       heatLevel: number; // 0-5
       color: string; // Tailwind color prefix (e.g., 'nacho', 'spice')
       emoji: string;
       badge: string;
       isStar: boolean; // true only for MEGA SPICE
     };
     ```
   - Export `flavors: Flavor[]` array with all 5 flavors:
     - white-cheese: "White Cheese Sauce", "Classic Mild", heatLevel 0, color 'white-cheese', emoji 'ðŸ¤', badge 'Classic Mild', isStar false
     - orange-spice: "Orange Cheese with Spice", "Signature Blend", heatLevel 2, color 'nacho', emoji 'ðŸ§¡', badge 'Signature Blend', isStar false
     - mozz-pure: "Mozz Pure", "Smooth Operator", heatLevel 0, color 'mozz', emoji 'ðŸ’™', badge 'Smooth Operator', isStar false
     - cheddar-beddar: "Cheddar is Beddar", "Bold & Sharp", heatLevel 1, color 'cheddar', emoji 'ðŸ§€', badge 'Bold & Sharp', isStar false
     - mega-spice: "MEGA SPICE Face Melter", "Maximum Heat", heatLevel 5, color 'spice', emoji 'ðŸ”¥', badge 'Maximum Heat', isStar true
   - Write engaging, personality-rich descriptions for each flavor (2-3 sentences each, matching the west coast cool vibe from PROJECT.md)

5. Update `src/routes/+layout.svelte`:
   - Add page transitions using SvelteKit's built-in `onNavigate` from `$app/navigation`
   - Import `onNavigate` and add the View Transitions API pattern:
     ```
     onNavigate((navigation) => {
       if (!document.startViewTransition) return;
       return new Promise((resolve) => {
         document.startViewTransition(async () => {
           resolve();
           await navigation.complete;
         });
       });
     });
     ```
   - Add a `<style>` block with `@media (prefers-reduced-motion: no-preference)` wrapping `::view-transition-old(root)` and `::view-transition-new(root)` with crossfade animation (0.3s ease)
   - Keep all existing layout markup exactly as-is (Nav, MobileDrawer, Footer, responsive switching)

  </action>
  <verify>
Run `bun run check` â€” 0 errors, 0 warnings.
Run `bun run build` â€” build succeeds.
Verify all new files exist and export correctly:
- `ls src/lib/utils/scroll-animations.ts`
- `ls src/lib/actions/inview.ts`
- `ls src/lib/actions/cheese-stretch.ts`
- `ls src/lib/data/flavors.ts`
  </verify>
  <done>
All 4 new utility/action/data files exist with correct exports. Page transitions are wired into the root layout. `bun run build` succeeds with zero errors.
  </done>
</task>

</tasks>

<verification>
1. `bun run build` completes without errors
2. `bun run check` shows 0 errors, 0 warnings
3. All 4 new files exist under src/lib/
4. tailwind.config.js has mozz colors, white-cheese colors, and 4 custom animations
5. +layout.svelte contains View Transitions API integration
6. Flavor data module exports typed array of 5 flavors
</verification>

<success_criteria>
- Build passes with all new code
- Scroll-animation configs exist for all 5 flavor IDs
- Inview action uses Intersection Observer with proper cleanup
- Cheese-stretch action uses spring with proper cleanup
- Flavor data is typed and complete for all 5 products
- Page transitions use View Transitions API with reduced-motion support
</success_criteria>

<output>
After completion, create `.planning/phases/02-product-showcase/02-01-SUMMARY.md`
</output>
